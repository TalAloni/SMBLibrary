---
description: Spec‑Then‑Code — Tasks from SPEC
auto_execution_mode: 3
---

# Goal

Decompose the sprint SPEC into an actionable, prioritized task list mapped to each Acceptance Criterion (AC), with explicit test and telemetry work. LLM‑direct, no temp orchestration. Repeatable per sprint.

## Inputs

- **Sprint**: `YYYY-MM-sprint-NN`
- **SPEC path**: defaults to `docs/sprints/{sprint}/SPEC.md`
- **Granularity target**: ≤2 days per task
- **Modules**: Affected .NET/Python modules (optional)
- **Include**: `tests`, `telemetry`, `docs` (defaults: all)

## Outputs

- `docs/sprints/{sprint}/TASKS.md` — tasks grouped by SPEC ACs, prioritized (Must/Should/Could)

## Steps

### 1. Read SPEC and extract scope

1. **Assistant**: Open the SPEC and collect:
   - Acceptance Criteria (IDs, titles)
   - Interfaces and module boundaries
   - Telemetry and risk notes
   - Feature flags and rollback items

### 2. Generate tasks per Acceptance Criterion (AC)

1. **Assistant**: For each AC, generate tasks across these areas (as applicable):
   - Domain/Application implementation
   - Infrastructure/Adapters (OpenSearch, DB, HTTP, queues)
   - UI/Endpoints (if present)
   - Tests: unit, integration, E2E (map AC → tests)
   - Telemetry: OTEL spans/tags, logs with trace context, metrics
   - Feature flags/config migrations
   - Docs/contracts updates

1. **Task details**: Each task should include:
   - Title, description
   - Size estimate (S ≤ 0.5d, M ≤ 1d, L ≤ 2d)
   - Dependencies/blockers
   - Test plan link (what tests validate it)
   - Telemetry plan link (what spans/tags/metrics)
   - Reference to SPEC AC ID

### 3. Deduplicate and sequence

1. **Assistant**: Merge cross‑AC tasks and remove duplicates.

1. **Assistant**: Sequence tasks considering dependencies and module boundaries.

### 4. Prioritize

1. **Assistant**: Mark priority per task: Must / Should / Could.

### 5. Emit TASKS.md

// turbo

1. Ensure output folder exists

   Run: `node -e "const fs=require('fs'); const p='docs/sprints/{sprint}'; fs.mkdirSync(p,{recursive:true}); console.log('ensured',p);"`

1. **Assistant**: Create or update `docs/sprints/{sprint}/TASKS.md` with the structure below.

#### TASKS.md structure (template)

```markdown
# Sprint {sprint} — Task List (from SPEC)

- SPEC: docs/sprints/{sprint}/SPEC.md
- Granularity target: ≤2 days per task
- Generated by: /spec-then-code-tasks

## Summary

- Must: <count>
- Should: <count>
- Could: <count>

## Tasks by Acceptance Criterion

### AC-{id}: {title}

- Context: <short summary>
- Validation: <Given/When/Then or reference>

#### Tasks

- [ ] [Must|Should|Could] {task title} — {S|M|L}
  - Desc: <what to do>
  - Module: <module>
  - Depends on: <task IDs or external>
  - Tests: <unit/integration/E2E refs>
  - Telemetry: <spans/tags/metrics>
  - Ref: SPEC AC-{id}

(repeat for each task)

## Cross‑cutting Tasks

- [ ] {task title} — {S|M|L}
  - Area: tests/telemetry/docs/infra
  - Desc: <what to do>
  - Depends on: <task IDs>

## Ordering Proposal

1. <task-id or title>
1. <task-id or title>
1. <task-id or title>
```

### 6. Hand‑off

1. **Assistant**: Propose the first item(s) to implement and run `/start-development` (TDD) for each in order.

## Guardrails and References

- **TDD**: `.windsurf/rules/rules-tdd.md`
- **Architecture**: `.windsurf/rules/rules-architecture-dotnet.md`, `.windsurf/rules/rules-architecture-python.md`
- **Testing**: `.windsurf/rules/rules-unit-testing-csharp.md`, `.windsurf/rules/rules-unit-testing-python.md`
- **Observability**: `.windsurf/rules/rules-observability.md`
- **Security**: `.windsurf/rules/rules-security.md`

## Acceptance Checklist

- [ ] All SPEC ACs mapped to tasks
- [ ] Each task has test and telemetry plans
- [ ] Tasks sized ≤2 days and prioritized
- [ ] Duplicates merged; dependencies captured
- [ ] `TASKS.md` created/updated and committed
- [ ] First item ready for `/start-development`
